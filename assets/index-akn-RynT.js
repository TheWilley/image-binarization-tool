import{j as e,r as h,u as R,b as M,c as D,B as P}from"./react-vendor-0CuSiqFf.js";import"./vendor-5d10CC1f.js";import{r as U}from"./image-js-vendor-Xxtjpwic.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))n(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function o(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerPolicy&&(r.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?r.credentials="include":t.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(t){if(t.ep)return;t.ep=!0;const r=o(t);fetch(t.href,r)}})();function O(){return e.jsx("footer",{className:"mt-12 text-center text-sm text-base-content/70",children:e.jsxs("p",{children:["Made by TheWilley • Source code avaible at"," ",e.jsx("a",{href:"https://github.com/TheWilley/image-binarization-tool",className:"link",target:"_blank",children:"GitHub"})]})})}function _({children:a}){return e.jsx("div",{className:"min-h-screen bg-base-100 flex flex-col items-center p-6 font-['Inter']",children:e.jsx("div",{className:"max-w-5xl w-full",children:a})})}function J({tabs:a,children:s,defaultTab:o}){const[n,t]=h.useState(o||a[0].key),r=R();h.useEffect(()=>{o&&t(o)},[o]);const i=l=>{t(l),r(`?tab=${l}`)};return e.jsxs("div",{children:[e.jsx("div",{role:"tablist",className:"tabs tabs-border mb-2",children:a.map(l=>e.jsx("a",{role:"tab",className:`tab ${n===l.key?"tab-active":""}`,onClick:()=>i(l.key),children:l.label},l.key))}),e.jsx("div",{children:Object.keys(s).map((l,c)=>e.jsx("div",{style:{display:n===a[c].key?"block":"none"},children:s[l]},c))})]})}function G({title:a}){return e.jsx("header",{className:"text-center mb-6 w-full",children:e.jsx("h1",{className:"text-4xl sm:text-5xl font-extrabold mb-2 tracking-tight",children:a})})}function L({title:a,nullText:s,url:o,processing:n,altText:t}){return e.jsxs("div",{className:"card border border-base-300 p-4 rounded-lg bg-[#0a0a0a]",children:[e.jsx("h3",{className:"card-title text-xl font-semibold mb-3",children:a}),e.jsxs("div",{className:"min-h-72 flex items-center justify-center rounded-lg overflow-hidde relative",children:[o&&e.jsx("img",{src:o,alt:t,className:`
              w-full h-full object-contain max-h-[60vh]
              transition duration-500 ease-in
            `}),e.jsx("div",{className:"absolute text-center",children:n?e.jsx("span",{className:"text-primary p-8",children:e.jsx("div",{className:"loading loading-infinity loading-xl scale-200 bg-purple-900"})}):!o&&e.jsx("div",{className:"text-neutral-focus p-8",children:s})})]})]})}function A({url:a,processing:s}){const o=()=>{a&&window.open(a,"_blank")?.focus()},n=()=>{if(a){const t=document.createElement("a");t.href=a,t.download="binarization_image.png",t.click()}};return e.jsx("div",{className:"card bg-base-100 w-full shadow-md mb-5",children:e.jsxs("div",{className:"card-body p-0 grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("button",{className:"btn",onClick:n,disabled:s||!a,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"size-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"})}),"Save Image"]}),e.jsxs("button",{className:"btn",onClick:o,disabled:s||!a,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"size-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"})}),"Open Image"]})]})})}const B=["width","height","belowThresholdColor","aboveThresholdColor","runs"],I="|";function C(a){const s=parseInt(a.slice(1,3),16),o=parseInt(a.slice(3,5),16),n=parseInt(a.slice(5,7),16);return{r:s,g:o,b:n}}function T(a,s){return s==="add"?`#${a}`:a.replace(/^#/,"")}class E{rgbaToBinary(s,o){const n=s.length/4,t=new Uint8Array(n),r=C(o.aboveThresholdColor),i=C(o.belowThresholdColor),{r:l,g:c,b:g}=i,{r:u,g:d,b:m}=r;for(let f=0;f<n;f++){const p=f*4,j=s[p],x=s[p+1],v=s[p+2];j===l&&x===c&&v===g?t[f]=0:j===u&&x===d&&v===m&&(t[f]=1)}return t}binaryToRgba(s,o){const n=new Uint8ClampedArray(s.length*4),t=C(o.aboveThresholdColor),r=C(o.belowThresholdColor);for(let i=0;i<s.length;i++){const l=i*4,c=s[i]===1?t:r;n[l]=c.r,n[l+1]=c.g,n[l+2]=c.b,n[l+3]=255}return n}encodeRunLength(s){if(s.length===0)return[];const o=[];let n=s[0];o.push(n);let t=0;for(let r=0;r<s.length;r++)s[r]!==n?(o.push(t),t=1,n=s[r]):t++;return o.push(t),o}decodeRunLength(s){if(s.length===0)return new Uint8Array(0);let o=0;for(let i=1;i<s.length;i++)o+=s[i];const n=new Uint8Array(o);let t=s[0],r=0;for(let i=1;i<s.length;i++){const l=s[i];n.fill(t,r,r+l),r+=l,t=1-t}return n}stringifyRunLength(s){return[s.width,s.height,T(s.colors.belowThresholdColor,"remove"),T(s.colors.aboveThresholdColor,"remove"),s.runs.join(",")].join(I)}parseRunLengthString(s){const o=s.split(I);if(o.length<B.length)return null;const[n,t,r,i,l]=o,c=parseInt(n,10),g=parseInt(t,10);return isNaN(c)||isNaN(g)?null:{width:c,height:g,colors:{belowThresholdColor:T(r,"add"),aboveThresholdColor:T(i,"add")},runs:l?l.split(",").map(Number):[]}}processImageData(s,o,n,t){const r=this.rgbaToBinary(n,t),i=this.encodeRunLength(r),l={colors:t,width:s,height:o,runs:i};return this.stringifyRunLength(l)}decodeImageData(s){const o=this.parseRunLengthString(s);if(!o)throw new Error("Invalid RLE data");const{width:n,height:t,runs:r,colors:i}=o,l=this.decodeRunLength(r),c=this.binaryToRgba(l,i);return{width:n,height:t,rgbaData:c}}}function H(a){const[s,o]=h.useState(null),[n,t]=h.useState(!1),[r,i]=h.useState(null);return{handleDecode:()=>{if(a.trim())try{t(!0);const{width:c,height:g,rgbaData:u}=new E().decodeImageData(a),d=document.createElement("canvas");d.width=c,d.height=g;const m=d.getContext("2d");if(m){m.imageSmoothingEnabled=!1;const f=new Uint8ClampedArray(u),p=new ImageData(f,c,g);m.putImageData(p,0,0),d.toBlob(j=>{if(j){const x=URL.createObjectURL(j);o(x)}t(!1)}),i(null)}}catch(c){console.error("Failed to decode image:",c),i("Failed to decode image. Please check the encoded data format."),t(!1)}},decodedImageUrl:s,processing:n,error:r}}function W(){const[a,s]=h.useState(""),{handleDecode:o,decodedImageUrl:n,processing:t,error:r}=H(a);return e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{className:"card bg-[#0a0a0a] border border-base-300 p-4 rounded-lg",children:[e.jsx("h3",{className:"card-title text-xl font-semibold mb-3",children:"Input Encoded Data"}),e.jsx("textarea",{className:"textarea w-full font-mono",placeholder:"Paste the RLE encoded data here...",value:a,onChange:i=>s(i.target.value)}),e.jsx("button",{className:"btn mt-4",onClick:o,disabled:t,children:t?"Decoding...":"Decode"}),r&&e.jsx("p",{className:"text-red-500 mt-2 text-center",children:r})]}),e.jsx(L,{title:"Decoded Image",nullText:"Decoded image will appear here",url:n,processing:t,altText:"Decoded image from RLE data"}),e.jsx(A,{processing:t,url:n})]})}const z=["manual","huang","intermodes","isodata","li","maxEntropy","mean","minimum","minError","moments","otsu","percentile","renyiEntropy","shanbhag","triangle","yen"];function V(a){let s;try{s=new URL(a)}catch{return!1}return s.protocol==="http:"||s.protocol==="https:"}const K={huang:["https://github.com/image-js/image-js/blob/main/src/operations/thresholds/huang.ts","https://imagej.net/ij/developer/source/ij/process/AutoThresholder.java.html","[NewLine]","Huang, L.-K., & Wang, M.-J. J. (1995). Image thresholding by minimizing the measures of fuzziness. Pattern Recognition, 28(1), 41–51","https://doi.org/10.1016/0031-3203(94)E0043-K"],intermodes:["https://github.com/image-js/image-js/blob/main/src/operations/thresholds/intermodes.ts","https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java","[NewLine]","Prewitt, J. M. S., & Mendelsohn, M. L. (1966). The analysis of cell images. Annals of the New York Academy of Sciences, 128(3), 1035–1053","https://doi.org/10.1111/j.1749-6632.1965.tb11715.x"],isodata:["https://github.com/image-js/image-js/blob/main/src/operations/thresholds/isodata.ts","https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java","[NewLine]","Ridler, T. W., & Calvard, S. (1978). Picture thresholding using an iterative selection method. IEEE Transactions on Systems, Man, and Cybernetics, 8(8), 630–632","https://doi.org/10.1109/TSMC.1978.4310039"],li:["https://github.com/image-js/image-js/blob/main/src/operations/thresholds/li.ts","https://imagej.net/ij/developer/source/ij/process/AutoThresholder.java.html","[NewLine]","Li, C. H., & Lee, C. K. (1993). Minimum cross entropy thresholding. Pattern Recognition, 26(4), 617–625","https://doi.org/10.1016/0031-3203(93)90115-D","[NewLine]","Li, C. H., & Tam, P. K. S. (1998). An iterative algorithm for minimum cross entropy thresholding. Pattern Recognition Letters, 19(8), 771–776","https://doi.org/10.1016/S0167-8655(98)00057-9","[NewLine]","Sezgin, M., & Sankur, B. (2004). Survey over image thresholding techniques and quantitative performance evaluation. Journal of Electronic Imaging, 13(1), 146–165","https://doi.org/10.1117/1.1631315"],maxEntropy:["https://github.com/image-js/image-js/blob/main/src/operations/thresholds/maxEntropy.ts","https://imagej.net/ij/developer/source/ij/process/AutoThresholder.java.html","[NewLine]","Kapur, J. N., Sahoo, P. K., & Wong, A. K. C. (1985). A new method for gray-level picture thresholding using the entropy of the histogram. Computer Vision, Graphics, and Image Processing, 29(3), 273–285","https://doi.org/10.1016/0734-189X(85)90125-2"],mean:["https://github.com/image-js/image-js/blob/main/src/operations/thresholds/mean.ts","[NewLine]","Glasbey, C. A. (1993). An analysis of histogram-based thresholding algorithms. CVGIP: Graphical Models and Image Processing, 55(6), 532–537","https://doi.org/10.1006/cgip.1993.1040"],minimum:["https://github.com/image-js/image-js/blob/main/src/operations/thresholds/minimum.ts","https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java","[NewLine]","Prewitt, J. M. S., & Mendelsohn, M. L. (1966). The analysis of cell images. Annals of the New York Academy of Sciences, 128(3), 1035–1053","https://doi.org/10.1111/j.1749-6632.1965.tb11715.x","[NewLine]","Ported to ImageJ plugin by G.Landini from Antti Niemisto's Matlab code (GPL)","Original Matlab code Copyright (C) 2004 Antti Niemisto","http://www.cs.tut.fi/~ant/histthresh/"],minError:["https://github.com/image-js/image-js/blob/main/src/operations/thresholds/minError.ts","https://imagej.net/ij/developer/source/ij/process/AutoThresholder.java.html","[NewLine]","Kittler, J., & Illingworth, J. (1986). Minimum error thresholding. Pattern Recognition, 19(1), 41–47","https://doi.org/10.1016/0031-3203(86)90030-0"],moments:["https://github.com/image-js/image-js/blob/main/src/operations/thresholds/moments.ts","https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java","[NewLine]","Tsai, W. H. (1985). Moment-preserving thresholding: A new approach. Computer Vision, Graphics, and Image Processing, 29(3), 377–393","https://doi.org/10.1016/0734-189X(85)90133-1","[NewLine]","Ported to ImageJ plugin by G.Landini from the the open source project FOURIER 0.8  by M. Emre Celebi, Department of Computer Science, Louisiana State University in Shreveport","Shreveport, LA 71115, USA","[NewLine]","http://sourceforge.net/projects/fourier-ipal","http://www.lsus.edu/faculty/~ecelebi/fourier.htm"],otsu:["https://github.com/image-js/image-js/blob/main/src/operations/thresholds/otsu.ts","https://en.wikipedia.org/wiki/Otsu's_method","[NewLine]","Otsu, N. (1979). A threshold selection method from gray-level histograms. IEEE Transactions on Systems, Man, and Cybernetics, 9(1), 62–66","https://doi.org/10.1109/TSMC.1979.4310076"],percentile:["https://github.com/image-js/image-js/blob/main/src/operations/thresholds/percentile.ts","https://imagej.net/ij/download/tools/source/ij/process/AutoThresholder.java","[NewLine]","Doyle, W. (1962). Operations useful for similarity-invariant pattern recognition. Journal of the ACM, 9(2), 259–267","https://doi.org/10.1145/321119.321123","[NewLine]","Ported to ImageJ plugin by G.Landini from Antti Niemisto's Matlab code (GPL).","Original Matlab code Copyright (C) 2004 Antti Niemisto","http://www.cs.tut.fi/~ant/histthresh/"],renyiEntropy:["https://github.com/image-js/image-js/blob/main/src/operations/thresholds/renyiEntropy.ts","https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java","[NewLine]","Kapur, J. N., Sahoo, P. K., & Wong, A. K. C. (1985). A new method for gray-level picture thresholding using the entropy of the histogram. Computer Vision, Graphics, and Image Processing, 29(3), 273–285","https://doi.org/10.1016/0734-189X(85)90125-2","[NewLine]","M. Emre Celebi, 06.15.2007","Ported to ImageJ plugin by G.Landini from E Celebi's fourier_0.8 routines"],shanbhag:["https://github.com/image-js/image-js/blob/main/src/operations/thresholds/shanbhag.ts","https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java","[NewLine]","Shanbhag, A. G. (1994). Utilization of information measure as a means of image thresholding. Computer Vision, Graphics, and Image Processing: Graphical Models and Image Processing, 56(5), 414–419","https://doi.org/10.1006/cgip.1994.1037","[NewLine]","Ported to ImageJ plugin by G.Landini from E Celebi's fourier_0.8 routines"],triangle:["https://github.com/image-js/image-js/blob/main/src/operations/thresholds/triangle.ts","https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java","[NewLine]","Zack, G. W., Rogers, W. E., & Latt, S. A. (1977). Automatic measurement of sister chromatid exchange frequency. Journal of Histochemistry & Cytochemistry, 25(7), 741–753","https://doi.org/10.1177/25.7.70454","[NewLine]","Modified from Johannes Schindelin plugin"],yen:["https://github.com/image-js/image-js/blob/main/src/operations/thresholds/yen.ts","https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java","[NewLine]","Yen, J. C., Chang, F. J., & Chang, S. (1995). A new criterion for automatic multilevel thresholding. IEEE Transactions on Image Processing, 4(3), 370–378","https://doi.org/10.1109/83.366472","[NewLine]","Sezgin, M., & Sankur, B. (2004). Survey over image thresholding techniques and quantitative performance evaluation. Journal of Electronic Imaging, 13(1), 146–165","https://doi.org/10.1117/1.1631315","http://citeseer.ist.psu.edu/sezgin04survey.html","[NewLine]","M. Emre Celebi, 06.15.2007","Ported to ImageJ plugin by G.Landini from E Celebi's fourier_0.8 routines"],manual:[]};function F(a){const[s,o]=h.useState(!1),n="[NewLine]";return e.jsxs("div",{className:"collapse collapse-plus bg-base-100 border border-accent mt-2",children:[e.jsx("input",{type:"checkbox",checked:s,onChange:t=>o(t.currentTarget.checked)}),e.jsx("div",{className:"collapse-title font-semibold",children:"References"}),e.jsx("div",{className:"collapse-content",children:e.jsx("ul",{className:"p-1 list-disc ml-3",children:a.references.map(t=>e.jsx("li",{className:t===n?"list-none ":"",children:V(t)?e.jsx("a",{href:t,className:"link",target:"_blank",children:t}):e.jsxs("p",{children:[" ",t===n?e.jsx(e.Fragment,{children:" "}):t," "]})},t))})})]})}function q({algorithm:a}){const s=K[a];return!s||a==="manual"?null:e.jsx(F,{references:s})}function $({selectedFile:a,setThreshold:s,processing:o,algorithm:n,invert:t,colors:r,showLargeFileWarning:i,setSelectedFile:l,setAlgorithm:c,setInvert:g,setColors:u}){const[d,m]=h.useState(128),f=b=>{const N=b.target.files?.[0];N&&N.type.startsWith("image/")?l(N):l(null)},p=b=>{m(Number(b.target.value))},j=()=>{s(d)},x=b=>{c(b.target.value)},v=b=>{g(b.target.checked)},w=b=>{const{name:N,value:S}=b.target;u(k=>({...k,[N]:S}))},y=()=>{(r.aboveThresholdColor!=="#ffffff"||r.belowThresholdColor!=="#000000")&&u({aboveThresholdColor:"#ffffff",belowThresholdColor:"#000000"})};return e.jsx("div",{className:"card bg-[#0a0a0a] border rounded-lg border-base-300 w-full mb-4",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"form-control mb-2",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text font-semibold mb-2",children:"Upload Image (.jpg or .png)"})}),e.jsx("input",{type:"file",accept:"image/*",onChange:f,className:"file-input file-input-bordered w-full"})]}),i&&e.jsx("span",{className:"text-warning",children:"The uploaded image exceeds 1MB, which may result in longer processing times."}),e.jsxs("fieldset",{className:"fieldset border border-base-300 p-3 rounded-md shadow-md shadow-black",children:[e.jsx("legend",{className:"fieldset-legend",children:"Settings"}),e.jsxs("div",{className:"form-control mb-6",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text font-semibold mb-2",children:"Threshold Algorithm"})}),e.jsx("select",{value:n,onChange:x,className:"select select-bordered select-primary w-full",disabled:!a||o,children:z.map(b=>e.jsx("option",{value:b,children:b},b))}),e.jsx(q,{algorithm:n})]}),n==="manual"&&e.jsxs("div",{className:"form-control mb-6",children:[e.jsx("label",{className:"label",children:e.jsxs("span",{className:"label-text font-semibold mb-2",children:["Threshold Value (0–255):"," ",e.jsx("span",{className:"text-base-content",children:d})," "]})}),e.jsx("input",{type:"range",min:"0",max:"255",value:d,onChange:p,onMouseUp:j,onTouchEnd:j,disabled:!a||o,className:"range range-primary w-full"})]}),e.jsxs("div",{className:"form-control mb-6",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text font-semibold mb-2",children:"Colors"})}),e.jsx("br",{}),e.jsxs("label",{className:"label",children:[e.jsx("input",{type:"color",name:"aboveThresholdColor",value:r.aboveThresholdColor,onChange:w,disabled:!a||o,className:""}),"Above Threshold"]}),e.jsx("br",{}),e.jsxs("label",{className:"label mt-2",children:[e.jsx("input",{type:"color",name:"belowThresholdColor",value:r.belowThresholdColor,onChange:w,disabled:!a||o,className:""}),"Below Threshold"]}),e.jsx("br",{}),e.jsx("button",{className:"btn btn-sm mt-2",onClick:y,disabled:r.aboveThresholdColor=="#ffffff"&&r.belowThresholdColor=="#000000",children:"Default"})]}),e.jsxs("div",{className:"form-control mb-6",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text font-semibold mb-2",children:"Modifiers"})}),e.jsx("br",{}),e.jsxs("label",{className:"label",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:v,disabled:!a||o,className:"toggle toggle-primary"}),"Invert Colors"]})]})]})]})})}function Z({originalUrl:a,algorithm:s,threshold:o,thresholdedUrl:n,processing:t}){return e.jsxs("div",{className:"w-full grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsx(L,{title:"Original Image",nullText:"Upload an image above to begin",url:a,processing:t&&!a,altText:"Original image uploaded by user"}),e.jsx(L,{title:`Thresholded Image (${s})`,nullText:"Thresholded result will appear here",url:n,processing:t,altText:`Binarized image using ${s} algorithm and threshold ${o}`})]})}function X(){return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"size-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 7.5V6.108c0-1.135.845-2.098 1.976-2.192.373-.03.748-.057 1.123-.08M15.75 18H18a2.25 2.25 0 0 0 2.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 0 0-1.123-.08M15.75 18.75v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5A3.375 3.375 0 0 0 6.375 7.5H5.25m11.9-3.664A2.251 2.251 0 0 0 15 2.25h-1.5a2.251 2.251 0 0 0-2.15 1.586m5.8 0c.065.21.1.433.1.664v.75h-6V4.5c0-.231.035-.454.1-.664M6.75 7.5H4.875c-.621 0-1.125.504-1.125 1.125v12c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V16.5a9 9 0 0 0-9-9Z"})})}function Y(){return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"size-6",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 5.25h.008v.008H12v-.008Z"})})}function Q({label:a,data:s,tooltip:o,actionButtons:n}){return e.jsxs("div",{tabIndex:0,className:"collapse collapse-arrow bg-[#0a0a0a] border rounded-lg border-base-300 w-full mb-2",children:[e.jsx("div",{className:"collapse-title font-semibold",children:a}),e.jsxs("div",{className:"collapse-content text-sm",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[n.map(t=>e.jsxs("button",{className:"btn",onClick:t.action,children:[t.icon,t.text]},t.text)),e.jsx("div",{className:"tooltip tooltip-left cursor-pointer p-1","data-tip":o,children:e.jsx(Y,{})})]}),e.jsx("textarea",{className:"textarea w-full font-mono bg-black/20",value:s,readOnly:!0})]})]})}function ee({encodedData:a}){const[s,o]=h.useState("Copy"),n=()=>{navigator.clipboard.writeText(a).then(()=>{o("Copied!"),setTimeout(()=>o("Copy"),2e3)})};return e.jsx("div",{className:"flex flex-col gap-2",children:e.jsx(Q,{label:"Show Encoded Data",data:a,tooltip:"This is the RLE encoded binary data of the thresholded image.",actionButtons:[{text:s,action:n,icon:e.jsx(X,{})}]})})}function te(a,s,o,n){const{width:t,height:r}=a,i=a.getRawImage().data;let l="";const c=document.createElement("canvas");c.width=t,c.height=r;const g=c.getContext("2d");if(g){g.imageSmoothingEnabled=!1;const u=C(o.aboveThresholdColor),d=C(o.belowThresholdColor),m=new Uint8ClampedArray(t*r*4);for(let p=0;p<t*r;p++){const j=!!i[p],v=(s?!j:j)?u:d,w=p*4;m[w]=v.r,m[w+1]=v.g,m[w+2]=v.b,m[w+3]=255}const f=new ImageData(m,t,r);l=new E().processImageData(t,r,m,o),g.putImageData(f,0,0)}c.toBlob(u=>{if(u){const d=URL.createObjectURL(u);n(d,l)}},"image/png")}async function se(a,s){const{algorithm:o,thresholdValue:n,invert:t}=s,i=U(a).grey(),l=o!=="manual"?{algorithm:o}:{threshold:n/255},c=i.threshold(l);return new Promise(g=>{te(c,t,s.colors,(u,d)=>{g({url:u,encodedData:d})})})}function oe(a,s,o,n,t){const[r,i]=h.useState(null),[l,c]=h.useState(null),[g,u]=h.useState(!1),[d,m]=h.useState(""),[f,p]=h.useState(!1),j=h.useCallback(()=>{if(!a){i(null),c(null);return}a&&a.size>1e6?p(!0):p(!1),u(!0);const x=new FileReader;x.onload=v=>{const w=v.target?.result;i(w);const y=new Image;y.src=w,y.onload=async()=>{try{const{url:b,encodedData:N}=await se(y,{algorithm:o,thresholdValue:s,invert:n,colors:t});m(N),c(b)}catch(b){console.error("Error processing image:",b),c(null)}finally{u(!1)}},y.onerror=()=>{console.error("Error loading image into HTMLImageElement."),u(!1)}},x.readAsDataURL(a)},[o,t,a,n,s]);return h.useEffect(()=>(j(),()=>{r&&URL.revokeObjectURL(r)}),[j,n]),{originalUrl:r,thresholdedUrl:l,processing:g,encodedData:d,fileIsLarge:f,processImage:j}}function ae(){const[a,s]=h.useState(128),[o,n]=h.useState("otsu"),[t,r]=h.useState(!1),[i,l]=h.useState({aboveThresholdColor:"#ffffff",belowThresholdColor:"#000000"});return{threshold:a,setThreshold:s,algorithm:o,setAlgorithm:n,invert:t,setInvert:r,colors:i,setColors:l}}function ne(){const[a,s]=h.useState(null),{algorithm:o,setAlgorithm:n,colors:t,setColors:r,invert:i,setInvert:l,threshold:c,setThreshold:g}=ae(),{originalUrl:u,thresholdedUrl:d,processing:m,encodedData:f,fileIsLarge:p}=oe(a,c,o,i,t);return e.jsxs(e.Fragment,{children:[e.jsx($,{threshold:c,selectedFile:a,processing:m,algorithm:o,colors:t,setSelectedFile:s,setThreshold:g,setAlgorithm:n,setInvert:l,invert:i,setColors:r,showLargeFileWarning:p}),e.jsx(Z,{algorithm:o,originalUrl:u,processing:m,threshold:c,thresholdedUrl:d}),e.jsx(A,{url:d,processing:m}),e.jsx(ee,{encodedData:f})]})}function re(){const[a]=M(),s=a.get("tab")==="decode"?"decode":"encode";return e.jsxs(_,{children:[e.jsx(G,{title:"Image Binarization Tool"}),e.jsx(J,{tabs:[{label:"Encode",key:"encode"},{label:"Decode",key:"decode"}],defaultTab:s,children:{encode:e.jsx(ne,{}),decode:e.jsx(W,{})}}),e.jsx(O,{})]})}D.createRoot(document.getElementById("root")).render(e.jsx(h.StrictMode,{children:e.jsx(P,{children:e.jsx(re,{})})}));
