import{o as e}from"./rolldown-runtime-tX5UdD3f.js";import{a as t,i as n,n as r,o as i,r as a,t as o}from"./react-vendor-BFlSrAF3.js";import{t as s}from"./image-js-vendor-J9je_fYw.js";(function(){let e=document.createElement(`link`).relList;if(e&&e.supports&&e.supports(`modulepreload`))return;for(let e of document.querySelectorAll(`link[rel="modulepreload"]`))n(e);new MutationObserver(e=>{for(let t of e)if(t.type===`childList`)for(let e of t.addedNodes)e.tagName===`LINK`&&e.rel===`modulepreload`&&n(e)}).observe(document,{childList:!0,subtree:!0});function t(e){let t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin===`use-credentials`?t.credentials=`include`:e.crossOrigin===`anonymous`?t.credentials=`omit`:t.credentials=`same-origin`,t}function n(e){if(e.ep)return;e.ep=!0;let n=t(e);fetch(e.href,n)}})();var c=e(t()),l=e(i()),u=e(n());function d(){return(0,u.jsx)(`footer`,{className:`mt-12 text-center text-sm text-base-content/70`,children:(0,u.jsxs)(`p`,{children:[`Made by TheWilley • Source code avaible at`,` `,(0,u.jsx)(`a`,{href:`https://github.com/TheWilley/image-binarization-tool`,className:`link`,target:`_blank`,children:`GitHub`})]})})}function f({children:e}){return(0,u.jsx)(`div`,{className:`min-h-screen bg-base-100 flex flex-col items-center p-6 font-['Inter']`,children:(0,u.jsx)(`div`,{className:`max-w-5xl w-full`,children:e})})}function p({tabs:e,children:t,defaultTab:n}){let[i,a]=(0,l.useState)(n||e[0].key),o=r();(0,l.useEffect)(()=>{n&&a(n)},[n]);let s=e=>{a(e),o(`?tab=${e}`)};return(0,u.jsxs)(`div`,{children:[(0,u.jsx)(`div`,{role:`tablist`,className:`tabs tabs-border mb-2`,children:e.map(e=>(0,u.jsx)(`a`,{role:`tab`,className:`tab ${i===e.key?`tab-active`:``}`,onClick:()=>s(e.key),children:e.label},e.key))}),(0,u.jsx)(`div`,{children:Object.keys(t).map((n,r)=>(0,u.jsx)(`div`,{style:{display:i===e[r].key?`block`:`none`},children:t[n]},r))})]})}function m({title:e}){return(0,u.jsx)(`header`,{className:`text-center mb-6 w-full`,children:(0,u.jsx)(`h1`,{className:`text-4xl sm:text-5xl font-extrabold mb-2 tracking-tight`,children:e})})}function h({title:e,nullText:t,url:n,processing:r,altText:i}){return(0,u.jsxs)(`div`,{className:`card border border-base-300 p-4 rounded-lg bg-[#0a0a0a]`,children:[(0,u.jsx)(`h3`,{className:`card-title text-xl font-semibold mb-3`,children:e}),(0,u.jsxs)(`div`,{className:`min-h-72 flex items-center justify-center rounded-lg overflow-hidde relative`,children:[n&&(0,u.jsx)(`img`,{src:n,alt:i,className:`
              w-full h-full object-contain max-h-[60vh]
              transition duration-500 ease-in
            `}),(0,u.jsx)(`div`,{className:`absolute text-center`,children:r?(0,u.jsx)(`span`,{className:`text-primary p-8`,children:(0,u.jsx)(`div`,{className:`loading loading-infinity loading-xl scale-200 bg-purple-900`})}):!n&&(0,u.jsx)(`div`,{className:`text-neutral-focus p-8`,children:t})})]})]})}function g({url:e,processing:t}){return(0,u.jsx)(`div`,{className:`card bg-base-100 w-full shadow-md mb-5`,children:(0,u.jsxs)(`div`,{className:`card-body p-0 grid grid-cols-1 md:grid-cols-2 gap-3`,children:[(0,u.jsxs)(`button`,{className:`btn`,onClick:()=>{if(e){let t=document.createElement(`a`);t.href=e,t.download=`binarization_image.png`,t.click()}},disabled:t||!e,children:[(0,u.jsx)(`svg`,{xmlns:`http://www.w3.org/2000/svg`,fill:`none`,viewBox:`0 0 24 24`,strokeWidth:1.5,stroke:`currentColor`,className:`size-5`,children:(0,u.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,d:`M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3`})}),`Save Image`]}),(0,u.jsxs)(`button`,{className:`btn`,onClick:()=>{e&&window.open(e,`_blank`)?.focus()},disabled:t||!e,children:[(0,u.jsx)(`svg`,{xmlns:`http://www.w3.org/2000/svg`,fill:`none`,viewBox:`0 0 24 24`,strokeWidth:1.5,stroke:`currentColor`,className:`size-5`,children:(0,u.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,d:`M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25`})}),`Open Image`]})]})})}const _=[`width`,`height`,`belowThresholdColor`,`aboveThresholdColor`,`runs`];function v(e){let t=parseInt(e.slice(1,3),16),n=parseInt(e.slice(3,5),16),r=parseInt(e.slice(5,7),16);return{r:t,g:n,b:r}}function y(e,t){return t===`add`?`#${e}`:e.replace(/^#/,``)}var b=class{rgbaToBinary(e,t){let n=e.length/4,r=new Uint8Array(n),i=v(t.aboveThresholdColor),{r:a,g:o,b:s}=v(t.belowThresholdColor),{r:c,g:l,b:u}=i;for(let t=0;t<n;t++){let n=t*4,i=e[n],d=e[n+1],f=e[n+2];i===a&&d===o&&f===s?r[t]=0:i===c&&d===l&&f===u&&(r[t]=1)}return r}binaryToRgba(e,t){let n=new Uint8ClampedArray(e.length*4),r=v(t.aboveThresholdColor),i=v(t.belowThresholdColor);for(let t=0;t<e.length;t++){let a=t*4,o=e[t]===1?r:i;n[a]=o.r,n[a+1]=o.g,n[a+2]=o.b,n[a+3]=255}return n}encodeRunLength(e){if(e.length===0)return[];let t=[],n=e[0];t.push(n);let r=0;for(let i=0;i<e.length;i++)e[i]===n?r++:(t.push(r),r=1,n=e[i]);return t.push(r),t}decodeRunLength(e){if(e.length===0)return new Uint8Array;let t=0;for(let n=1;n<e.length;n++)t+=e[n];let n=new Uint8Array(t),r=e[0],i=0;for(let t=1;t<e.length;t++){let a=e[t];n.fill(r,i,i+a),i+=a,r=1-r}return n}stringifyRunLength(e){return[e.width,e.height,y(e.colors.belowThresholdColor,`remove`),y(e.colors.aboveThresholdColor,`remove`),e.runs.join(`,`)].join(`|`)}parseRunLengthString(e){let t=e.split(`|`);if(t.length<_.length)return null;let[n,r,i,a,o]=t,s=parseInt(n,10),c=parseInt(r,10);return isNaN(s)||isNaN(c)?null:{width:s,height:c,colors:{belowThresholdColor:y(i,`add`),aboveThresholdColor:y(a,`add`)},runs:o?o.split(`,`).map(Number):[]}}processImageData(e,t,n,r){let i=this.rgbaToBinary(n,r),a=this.encodeRunLength(i),o={colors:r,width:e,height:t,runs:a};return this.stringifyRunLength(o)}decodeImageData(e){let t=this.parseRunLengthString(e);if(!t)throw Error(`Invalid RLE data`);let{width:n,height:r,runs:i,colors:a}=t,o=this.decodeRunLength(i),s=this.binaryToRgba(o,a);return{width:n,height:r,rgbaData:s}}};function x(e){let[t,n]=(0,l.useState)(null),[r,i]=(0,l.useState)(!1),[a,o]=(0,l.useState)(null);return{handleDecode:()=>{if(e.trim())try{i(!0);let{width:t,height:r,rgbaData:a}=new b().decodeImageData(e),s=document.createElement(`canvas`);s.width=t,s.height=r;let c=s.getContext(`2d`);if(c){c.imageSmoothingEnabled=!1;let e=new Uint8ClampedArray(a),l=new ImageData(e,t,r);c.putImageData(l,0,0),s.toBlob(e=>{if(e){let t=URL.createObjectURL(e);n(t)}i(!1)}),o(null)}}catch(e){console.error(`Failed to decode image:`,e),o(`Failed to decode image. Please check the encoded data format.`),i(!1)}},decodedImageUrl:t,processing:r,error:a}}function S(){let[e,t]=(0,l.useState)(``),{handleDecode:n,decodedImageUrl:r,processing:i,error:a}=x(e);return(0,u.jsxs)(`div`,{className:`grid grid-cols-1 gap-4`,children:[(0,u.jsxs)(`div`,{className:`card bg-[#0a0a0a] border border-base-300 p-4 rounded-lg`,children:[(0,u.jsx)(`h3`,{className:`card-title text-xl font-semibold mb-3`,children:`Input Encoded Data`}),(0,u.jsx)(`textarea`,{className:`textarea w-full font-mono`,placeholder:`Paste the RLE encoded data here...`,value:e,onChange:e=>t(e.target.value)}),(0,u.jsx)(`button`,{className:`btn mt-4`,onClick:n,disabled:i,children:i?`Decoding...`:`Decode`}),a&&(0,u.jsx)(`p`,{className:`text-red-500 mt-2 text-center`,children:a})]}),(0,u.jsx)(h,{title:`Decoded Image`,nullText:`Decoded image will appear here`,url:r,processing:i,altText:`Decoded image from RLE data`}),(0,u.jsx)(g,{processing:i,url:r})]})}const C=[`manual`,`huang`,`intermodes`,`isodata`,`li`,`maxEntropy`,`mean`,`minimum`,`minError`,`moments`,`otsu`,`percentile`,`renyiEntropy`,`shanbhag`,`triangle`,`yen`];function w(e){let t;try{t=new URL(e)}catch{return!1}return t.protocol===`http:`||t.protocol===`https:`}const T={huang:[`https://github.com/image-js/image-js/blob/main/src/operations/thresholds/huang.ts`,`https://imagej.net/ij/developer/source/ij/process/AutoThresholder.java.html`,`[NewLine]`,`Huang, L.-K., & Wang, M.-J. J. (1995). Image thresholding by minimizing the measures of fuzziness. Pattern Recognition, 28(1), 41–51`,`https://doi.org/10.1016/0031-3203(94)E0043-K`],intermodes:[`https://github.com/image-js/image-js/blob/main/src/operations/thresholds/intermodes.ts`,`https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java`,`[NewLine]`,`Prewitt, J. M. S., & Mendelsohn, M. L. (1966). The analysis of cell images. Annals of the New York Academy of Sciences, 128(3), 1035–1053`,`https://doi.org/10.1111/j.1749-6632.1965.tb11715.x`],isodata:[`https://github.com/image-js/image-js/blob/main/src/operations/thresholds/isodata.ts`,`https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java`,`[NewLine]`,`Ridler, T. W., & Calvard, S. (1978). Picture thresholding using an iterative selection method. IEEE Transactions on Systems, Man, and Cybernetics, 8(8), 630–632`,`https://doi.org/10.1109/TSMC.1978.4310039`],li:[`https://github.com/image-js/image-js/blob/main/src/operations/thresholds/li.ts`,`https://imagej.net/ij/developer/source/ij/process/AutoThresholder.java.html`,`[NewLine]`,`Li, C. H., & Lee, C. K. (1993). Minimum cross entropy thresholding. Pattern Recognition, 26(4), 617–625`,`https://doi.org/10.1016/0031-3203(93)90115-D`,`[NewLine]`,`Li, C. H., & Tam, P. K. S. (1998). An iterative algorithm for minimum cross entropy thresholding. Pattern Recognition Letters, 19(8), 771–776`,`https://doi.org/10.1016/S0167-8655(98)00057-9`,`[NewLine]`,`Sezgin, M., & Sankur, B. (2004). Survey over image thresholding techniques and quantitative performance evaluation. Journal of Electronic Imaging, 13(1), 146–165`,`https://doi.org/10.1117/1.1631315`],maxEntropy:[`https://github.com/image-js/image-js/blob/main/src/operations/thresholds/maxEntropy.ts`,`https://imagej.net/ij/developer/source/ij/process/AutoThresholder.java.html`,`[NewLine]`,`Kapur, J. N., Sahoo, P. K., & Wong, A. K. C. (1985). A new method for gray-level picture thresholding using the entropy of the histogram. Computer Vision, Graphics, and Image Processing, 29(3), 273–285`,`https://doi.org/10.1016/0734-189X(85)90125-2`],mean:[`https://github.com/image-js/image-js/blob/main/src/operations/thresholds/mean.ts`,`[NewLine]`,`Glasbey, C. A. (1993). An analysis of histogram-based thresholding algorithms. CVGIP: Graphical Models and Image Processing, 55(6), 532–537`,`https://doi.org/10.1006/cgip.1993.1040`],minimum:[`https://github.com/image-js/image-js/blob/main/src/operations/thresholds/minimum.ts`,`https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java`,`[NewLine]`,`Prewitt, J. M. S., & Mendelsohn, M. L. (1966). The analysis of cell images. Annals of the New York Academy of Sciences, 128(3), 1035–1053`,`https://doi.org/10.1111/j.1749-6632.1965.tb11715.x`,`[NewLine]`,`Ported to ImageJ plugin by G.Landini from Antti Niemisto's Matlab code (GPL)`,`Original Matlab code Copyright (C) 2004 Antti Niemisto`,`http://www.cs.tut.fi/~ant/histthresh/`],minError:[`https://github.com/image-js/image-js/blob/main/src/operations/thresholds/minError.ts`,`https://imagej.net/ij/developer/source/ij/process/AutoThresholder.java.html`,`[NewLine]`,`Kittler, J., & Illingworth, J. (1986). Minimum error thresholding. Pattern Recognition, 19(1), 41–47`,`https://doi.org/10.1016/0031-3203(86)90030-0`],moments:[`https://github.com/image-js/image-js/blob/main/src/operations/thresholds/moments.ts`,`https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java`,`[NewLine]`,`Tsai, W. H. (1985). Moment-preserving thresholding: A new approach. Computer Vision, Graphics, and Image Processing, 29(3), 377–393`,`https://doi.org/10.1016/0734-189X(85)90133-1`,`[NewLine]`,`Ported to ImageJ plugin by G.Landini from the the open source project FOURIER 0.8  by M. Emre Celebi, Department of Computer Science, Louisiana State University in Shreveport`,`Shreveport, LA 71115, USA`,`[NewLine]`,`http://sourceforge.net/projects/fourier-ipal`,`http://www.lsus.edu/faculty/~ecelebi/fourier.htm`],otsu:[`https://github.com/image-js/image-js/blob/main/src/operations/thresholds/otsu.ts`,`https://en.wikipedia.org/wiki/Otsu's_method`,`[NewLine]`,`Otsu, N. (1979). A threshold selection method from gray-level histograms. IEEE Transactions on Systems, Man, and Cybernetics, 9(1), 62–66`,`https://doi.org/10.1109/TSMC.1979.4310076`],percentile:[`https://github.com/image-js/image-js/blob/main/src/operations/thresholds/percentile.ts`,`https://imagej.net/ij/download/tools/source/ij/process/AutoThresholder.java`,`[NewLine]`,`Doyle, W. (1962). Operations useful for similarity-invariant pattern recognition. Journal of the ACM, 9(2), 259–267`,`https://doi.org/10.1145/321119.321123`,`[NewLine]`,`Ported to ImageJ plugin by G.Landini from Antti Niemisto's Matlab code (GPL).`,`Original Matlab code Copyright (C) 2004 Antti Niemisto`,`http://www.cs.tut.fi/~ant/histthresh/`],renyiEntropy:[`https://github.com/image-js/image-js/blob/main/src/operations/thresholds/renyiEntropy.ts`,`https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java`,`[NewLine]`,`Kapur, J. N., Sahoo, P. K., & Wong, A. K. C. (1985). A new method for gray-level picture thresholding using the entropy of the histogram. Computer Vision, Graphics, and Image Processing, 29(3), 273–285`,`https://doi.org/10.1016/0734-189X(85)90125-2`,`[NewLine]`,`M. Emre Celebi, 06.15.2007`,`Ported to ImageJ plugin by G.Landini from E Celebi's fourier_0.8 routines`],shanbhag:[`https://github.com/image-js/image-js/blob/main/src/operations/thresholds/shanbhag.ts`,`https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java`,`[NewLine]`,`Shanbhag, A. G. (1994). Utilization of information measure as a means of image thresholding. Computer Vision, Graphics, and Image Processing: Graphical Models and Image Processing, 56(5), 414–419`,`https://doi.org/10.1006/cgip.1994.1037`,`[NewLine]`,`Ported to ImageJ plugin by G.Landini from E Celebi's fourier_0.8 routines`],triangle:[`https://github.com/image-js/image-js/blob/main/src/operations/thresholds/triangle.ts`,`https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java`,`[NewLine]`,`Zack, G. W., Rogers, W. E., & Latt, S. A. (1977). Automatic measurement of sister chromatid exchange frequency. Journal of Histochemistry & Cytochemistry, 25(7), 741–753`,`https://doi.org/10.1177/25.7.70454`,`[NewLine]`,`Modified from Johannes Schindelin plugin`],yen:[`https://github.com/image-js/image-js/blob/main/src/operations/thresholds/yen.ts`,`https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java`,`[NewLine]`,`Yen, J. C., Chang, F. J., & Chang, S. (1995). A new criterion for automatic multilevel thresholding. IEEE Transactions on Image Processing, 4(3), 370–378`,`https://doi.org/10.1109/83.366472`,`[NewLine]`,`Sezgin, M., & Sankur, B. (2004). Survey over image thresholding techniques and quantitative performance evaluation. Journal of Electronic Imaging, 13(1), 146–165`,`https://doi.org/10.1117/1.1631315`,`http://citeseer.ist.psu.edu/sezgin04survey.html`,`[NewLine]`,`M. Emre Celebi, 06.15.2007`,`Ported to ImageJ plugin by G.Landini from E Celebi's fourier_0.8 routines`],manual:[]};function E(e){let[t,n]=(0,l.useState)(!1),r=`[NewLine]`;return(0,u.jsxs)(`div`,{className:`collapse collapse-plus bg-base-100 border border-accent mt-2`,children:[(0,u.jsx)(`input`,{type:`checkbox`,checked:t,onChange:e=>n(e.currentTarget.checked)}),(0,u.jsx)(`div`,{className:`collapse-title font-semibold`,children:`References`}),(0,u.jsx)(`div`,{className:`collapse-content`,children:(0,u.jsx)(`ul`,{className:`p-1 list-disc ml-3`,children:e.references.map(e=>(0,u.jsx)(`li`,{className:e===r?`list-none `:``,children:w(e)?(0,u.jsx)(`a`,{href:e,className:`link`,target:`_blank`,children:e}):(0,u.jsxs)(`p`,{children:[` `,e===r?(0,u.jsx)(u.Fragment,{children:`\xA0`}):e,` `]})},e))})})]})}function D({algorithm:e}){let t=T[e];return!t||e===`manual`?null:(0,u.jsx)(E,{references:t})}function O({selectedFile:e,setThreshold:t,processing:n,algorithm:r,invert:i,colors:a,showLargeFileWarning:o,setSelectedFile:s,setAlgorithm:c,setInvert:d,setColors:f}){let[p,m]=(0,l.useState)(128),h=e=>{let t=e.target.files?.[0];t&&t.type.startsWith(`image/`)?s(t):s(null)},g=e=>{m(Number(e.target.value))},_=()=>{t(p)},v=e=>{c(e.target.value)},y=e=>{d(e.target.checked)},b=e=>{let{name:t,value:n}=e.target;f(e=>({...e,[t]:n}))};return(0,u.jsx)(`div`,{className:`card bg-[#0a0a0a] border rounded-lg border-base-300 w-full mb-4`,children:(0,u.jsxs)(`div`,{className:`card-body`,children:[(0,u.jsxs)(`div`,{className:`form-control mb-2`,children:[(0,u.jsx)(`label`,{className:`label`,children:(0,u.jsx)(`span`,{className:`label-text font-semibold mb-2`,children:`Upload Image (.jpg or .png)`})}),(0,u.jsx)(`input`,{type:`file`,accept:`image/*`,onChange:h,className:`file-input file-input-bordered w-full`})]}),o&&(0,u.jsx)(`span`,{className:`text-warning`,children:`The uploaded image exceeds 1MB, which may result in longer processing times.`}),(0,u.jsxs)(`fieldset`,{className:`fieldset border border-base-300 p-3 rounded-md shadow-md shadow-black`,children:[(0,u.jsx)(`legend`,{className:`fieldset-legend`,children:`Settings`}),(0,u.jsxs)(`div`,{className:`form-control mb-6`,children:[(0,u.jsx)(`label`,{className:`label`,children:(0,u.jsx)(`span`,{className:`label-text font-semibold mb-2`,children:`Threshold Algorithm`})}),(0,u.jsx)(`select`,{value:r,onChange:v,className:`select select-bordered select-primary w-full`,disabled:!e||n,children:C.map(e=>(0,u.jsx)(`option`,{value:e,children:e},e))}),(0,u.jsx)(D,{algorithm:r})]}),r===`manual`&&(0,u.jsxs)(`div`,{className:`form-control mb-6`,children:[(0,u.jsx)(`label`,{className:`label`,children:(0,u.jsxs)(`span`,{className:`label-text font-semibold mb-2`,children:[`Threshold Value (0–255):`,` `,(0,u.jsx)(`span`,{className:`text-base-content`,children:p}),` `]})}),(0,u.jsx)(`input`,{type:`range`,min:`0`,max:`255`,value:p,onChange:g,onMouseUp:_,onTouchEnd:_,disabled:!e||n,className:`range range-primary w-full`})]}),(0,u.jsxs)(`div`,{className:`form-control mb-6`,children:[(0,u.jsx)(`label`,{className:`label`,children:(0,u.jsx)(`span`,{className:`label-text font-semibold mb-2`,children:`Colors`})}),(0,u.jsx)(`br`,{}),(0,u.jsxs)(`label`,{className:`label`,children:[(0,u.jsx)(`input`,{type:`color`,name:`aboveThresholdColor`,value:a.aboveThresholdColor,onChange:b,disabled:!e||n,className:``}),`Above Threshold`]}),(0,u.jsx)(`br`,{}),(0,u.jsxs)(`label`,{className:`label mt-2`,children:[(0,u.jsx)(`input`,{type:`color`,name:`belowThresholdColor`,value:a.belowThresholdColor,onChange:b,disabled:!e||n,className:``}),`Below Threshold`]}),(0,u.jsx)(`br`,{}),(0,u.jsx)(`button`,{className:`btn btn-sm mt-2`,onClick:()=>{(a.aboveThresholdColor!==`#ffffff`||a.belowThresholdColor!==`#000000`)&&f({aboveThresholdColor:`#ffffff`,belowThresholdColor:`#000000`})},disabled:a.aboveThresholdColor==`#ffffff`&&a.belowThresholdColor==`#000000`,children:`Default`})]}),(0,u.jsxs)(`div`,{className:`form-control mb-6`,children:[(0,u.jsx)(`label`,{className:`label`,children:(0,u.jsx)(`span`,{className:`label-text font-semibold mb-2`,children:`Modifiers`})}),(0,u.jsx)(`br`,{}),(0,u.jsxs)(`label`,{className:`label`,children:[(0,u.jsx)(`input`,{type:`checkbox`,checked:i,onChange:y,disabled:!e||n,className:`toggle toggle-primary`}),`Invert Colors`]})]})]})]})})}function k({originalUrl:e,algorithm:t,threshold:n,thresholdedUrl:r,processing:i}){return(0,u.jsxs)(`div`,{className:`w-full grid grid-cols-1 md:grid-cols-2 gap-4 mb-4`,children:[(0,u.jsx)(h,{title:`Original Image`,nullText:`Upload an image above to begin`,url:e,processing:i&&!e,altText:`Original image uploaded by user`}),(0,u.jsx)(h,{title:`Thresholded Image (${t})`,nullText:`Thresholded result will appear here`,url:r,processing:i,altText:`Binarized image using ${t} algorithm and threshold ${n}`})]})}function A({encodedData:e}){let[t,n]=(0,l.useState)(!1);return(0,u.jsx)(u.Fragment,{children:(0,u.jsxs)(`div`,{tabIndex:0,className:`collapse collapse-arrow bg-[#0a0a0a] border rounded-lg border-base-300 w-full`,children:[(0,u.jsx)(`div`,{className:`collapse-title font-semibold`,children:`Show Encoded Data`}),(0,u.jsxs)(`div`,{className:`collapse-content text-sm`,children:[(0,u.jsxs)(`button`,{className:`btn`,onClick:()=>{navigator.clipboard.writeText(e).then(()=>{n(!0),setTimeout(()=>n(!1),2e3)})},children:[(0,u.jsx)(`svg`,{xmlns:`http://www.w3.org/2000/svg`,fill:`none`,viewBox:`0 0 24 24`,strokeWidth:1.5,stroke:`currentColor`,className:`size-6`,children:(0,u.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,d:`M8.25 7.5V6.108c0-1.135.845-2.098 1.976-2.192.373-.03.748-.057 1.123-.08M15.75 18H18a2.25 2.25 0 0 0 2.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 0 0-1.123-.08M15.75 18.75v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5A3.375 3.375 0 0 0 6.375 7.5H5.25m11.9-3.664A2.251 2.251 0 0 0 15 2.25h-1.5a2.251 2.251 0 0 0-2.15 1.586m5.8 0c.065.21.1.433.1.664v.75h-6V4.5c0-.231.035-.454.1-.664M6.75 7.5H4.875c-.621 0-1.125.504-1.125 1.125v12c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V16.5a9 9 0 0 0-9-9Z`})}),t?`Copied!`:`Copy`]}),(0,u.jsx)(`div`,{className:`tooltip tooltip-left float-right cursor-pointer p-1`,"data-tip":`This is the RLE encoded binary data of the thresholded image.`,children:(0,u.jsx)(`svg`,{xmlns:`http://www.w3.org/2000/svg`,fill:`none`,viewBox:`0 0 24 24`,strokeWidth:1.5,stroke:`currentColor`,className:`size-6`,children:(0,u.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,d:`M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 5.25h.008v.008H12v-.008Z`})})}),(0,u.jsx)(`textarea`,{className:`textarea w-full font-mono`,value:e,readOnly:!0})]})]})})}function j(e,t,n,r){let{width:i,height:a}=e,o=e.getRawImage().data,s=``,c=document.createElement(`canvas`);c.width=i,c.height=a;let l=c.getContext(`2d`);if(l){l.imageSmoothingEnabled=!1;let e=v(n.aboveThresholdColor),r=v(n.belowThresholdColor),c=new Uint8ClampedArray(i*a*4);for(let n=0;n<i*a;n++){let i=!!o[n],a=(t?!i:i)?e:r,s=n*4;c[s]=a.r,c[s+1]=a.g,c[s+2]=a.b,c[s+3]=255}let u=new ImageData(c,i,a);s=new b().processImageData(i,a,c,n),l.putImageData(u,0,0)}c.toBlob(e=>{if(e){let t=URL.createObjectURL(e);r(t,s)}},`image/png`)}async function M(e,t){let{algorithm:n,thresholdValue:r,invert:i}=t,a=s(e).grey(),o=n===`manual`?{threshold:r/255}:{algorithm:n},c=a.threshold(o);return new Promise(e=>{j(c,i,t.colors,(t,n)=>{e({url:t,encodedData:n})})})}function N(e,t,n,r,i){let[a,o]=(0,l.useState)(null),[s,c]=(0,l.useState)(null),[u,d]=(0,l.useState)(!1),[f,p]=(0,l.useState)(``),[m,h]=(0,l.useState)(!1),g=(0,l.useCallback)(()=>{if(!e){o(null),c(null);return}e&&e.size>1e6?h(!0):h(!1),d(!0);let a=new FileReader;a.onload=e=>{let a=e.target?.result;o(a);let s=new Image;s.src=a,s.onload=async()=>{try{let{url:e,encodedData:a}=await M(s,{algorithm:n,thresholdValue:t,invert:r,colors:i});p(a),c(e)}catch(e){console.error(`Error processing image:`,e),c(null)}finally{d(!1)}},s.onerror=()=>{console.error(`Error loading image into HTMLImageElement.`),d(!1)}},a.readAsDataURL(e)},[n,i,e,r,t]);return(0,l.useEffect)(()=>(g(),()=>{a&&URL.revokeObjectURL(a)}),[g,r]),{originalUrl:a,thresholdedUrl:s,processing:u,encodedData:f,fileIsLarge:m,processImage:g}}function P(){let[e,t]=(0,l.useState)(null),[n,r]=(0,l.useState)(128),[i,a]=(0,l.useState)(`otsu`),[o,s]=(0,l.useState)(!1),[c,d]=(0,l.useState)({aboveThresholdColor:`#ffffff`,belowThresholdColor:`#000000`}),{originalUrl:f,thresholdedUrl:p,processing:m,encodedData:h,fileIsLarge:_}=N(e,n,i,o,c);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(O,{threshold:n,selectedFile:e,processing:m,algorithm:i,colors:c,setSelectedFile:t,setThreshold:r,setAlgorithm:a,setInvert:s,invert:o,setColors:d,showLargeFileWarning:_}),(0,u.jsx)(k,{algorithm:i,originalUrl:f,processing:m,threshold:n,thresholdedUrl:p}),(0,u.jsx)(g,{url:p,processing:m}),(0,u.jsx)(A,{encodedData:h})]})}function F(){let[e]=a(),t=e.get(`tab`)===`decode`?`decode`:`encode`;return(0,u.jsxs)(f,{children:[(0,u.jsx)(m,{title:`Image Binarization Tool`}),(0,u.jsx)(p,{tabs:[{label:`Encode`,key:`encode`},{label:`Decode`,key:`decode`}],defaultTab:t,children:{encode:(0,u.jsx)(P,{}),decode:(0,u.jsx)(S,{})}}),(0,u.jsx)(d,{})]})}(0,c.createRoot)(document.getElementById(`root`)).render((0,u.jsx)(l.StrictMode,{children:(0,u.jsx)(o,{children:(0,u.jsx)(F,{})})}));